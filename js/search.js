var searchFunc=function(e,t,n){var r=document.getElementById(t),a=document.getElementById(n);a.innerHTML="<ul><span class='local-search-empty'>首次搜索，正在载入索引文件，请稍后……<span></ul>",$.ajax({url:e,dataType:"xml",success:function(e){var t=$("entry",e).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get();a.innerHTML="",r.addEventListener("input",function(){var o='<ul class="search-result-list">',h=this.value.trim().toLowerCase().split(/[\s\-]+/);if(a.innerHTML="",!(this.value.trim().length<=0)){if(t.forEach(function(e){var n,r,a=!0,t=(e.title&&""!==e.title.trim()||(e.title="Untitled"),e.title.trim()),s=t.toLowerCase(),l=e.content.trim().replace(/<[^>]+>/g,""),c=l.toLowerCase(),e=e.url,i=-1,u=-1;""!==c?h.forEach(function(e,t){n=s.indexOf(e),i=c.indexOf(e),n<0&&i<0?a=!1:(i<0&&(i=0),0==t&&(u=i))}):a=!1,a&&(o+="<li><a href='"+e+"' class='search-result-title'>"+t+"</a>",0<=u&&(e=u+80,(e=0==(t=(t=u-20)<0?0:t)?100:e)>l.length&&(e=l.length),r=l.substr(t,e),h.forEach(function(e){var t=new RegExp(e,"gi");r=r.replace(t,'<span class="search-keyword">'+e+"</span>")}),o+='<p class="search-result-abstract">'+r+"...</p>"),o+="</li>")}),-1===(o+="</ul>").indexOf("<li>"))return a.innerHTML="<ul><span class='local-search-empty'>没有找到内容，请尝试更换检索词。<span></ul>";a.innerHTML=o}})}}),$(document).on("click","#search-close-icon",function(){$("#search-input").val(""),$("#search-result").html("")})},getSearchFile=function(){searchFunc("/search.xml","search-input","search-result")};